"use strict";var userAgent=navigator.userAgent,isAndroid=/android/gi.test(userAgent),_isProd=isAndroid;window.stringutil={template:function(e,t){return e.replace(/\{\w+\}/g,function(e){return t[e.replace(/\{|\}/g,"")]})},isMobile:function(e){return/^1\d{10}$/g.test(e)},isPassword:function(e){return/^[0-9a-zA-Z_]{6,16}$/g.test(e)}},function(e){e.arrayutil={flat:function t(e,n){var i=[];return e.forEach(function(e){Array.isArray(e)?i=i.concat(t(e,n)):(i.push(e),n&&Array.isArray(e[n])&&(i=i.concat(t(e[n],n))))}),i},split:function(e,t){for(var n=[];0!==e.length;)n.push(e.splice(0,t));return n},list2Tree:function(e){var t,n,i=e.list,a=e.parentKey||"parentId",r=e.idKey||"id",o=e.callback,s=[].concat(i).map(function(e){return Object.assign({},"function"==typeof o?o(e):{},e)}),u=(t=a,n={},s.forEach(function(e){e[t]&&(n[e[t]]=n[e[t]]||[],n[e[t]].push(e))}),n);return s.forEach(function(e){e.children=u[e[r]]}),s.filter(function(e){return!e[a]})},numberArray:function(n,e){return new Array(e-n+1).fill(1).map(function(e,t){return n+t})}}}(window),function(c){var n;c.apputil={parseparams:function(t,e){var n=[];e.forEach(function(e){void 0!==t[e]&&null!==t[e]&&""!==t[e]&&n.push(e+"="+t[e])});var i=n.join("&");return i?"?"+i:""},parseObj:function(n,e){return e.reduce(function(e,t){return e[t]=n[t],e},{})},objectKeys:Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},objectValues:Object.values||function(e){var t=[];for(var n in e)t.push(e[n]);return t},debounce:function(e,t){n?(new Date).getTime()-n>=e&&(t(),n=null):n=(new Date).getTime()},isProd:function(){return _isProd},ready:function(e){this.isProd()?c.apiready=e:$(e)},param:function(e){if(this.isProd())return api.pageParam[e];var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=unescape(decodeURI(c.location.search.substr(1))).match(t);return null!=n?JSON.parse(n[2]):null},fixStatusBar:function(e){util.app.isProd()?$api.fixStatusBar($api.byId(e)):$api.byId(e).style.paddingTop="0.26rem"},pullDownRefresh:function(n){util.app.isProd()&&api.setRefreshHeaderInfo({showTime:!0,visible:!0,bgColor:"rgba(255, 255, 255, 0)",textColor:"#ccc",textDown:"下拉刷新",textUp:"松开刷新"},function(e,t){setTimeout(function(){n(),api.refreshHeaderLoadDone()},300)})},appInstalled:function(e){if(this.isProd())return api.appInstalled({sync:!0,appBundle:e})},clearStorage:function(){$api.clearStorage()},removeStorage:function(e){$api.rmStorage(e)},storage:function(e,t){if(void 0===t)return(t=$api.getStorage(e))?t.startsWith("string-")?t.replace("string-",""):t.startsWith("boolean-")?JSON.parse(t.replace("boolean-","")):t.startsWith("number-")?+t.replace("number-",""):t.startsWith("object-")?JSON.parse(t.replace("object-","")):t:void 0;"string"==typeof t?$api.setStorage(e,"string-"+t):"boolean"==typeof t?$api.setStorage(e,"boolean-"+t):"number"==typeof t?$api.setStorage(e,"number-"+t):$api.setStorage(e,"object-"+JSON.stringify(t))},openWindow:function(e,t,n){if((n=n||{}).reload&&(e=e+"-"+(new Date).getTime()),n.name=e,this.isProd())api.openWin({name:e,url:t,pageParam:n,bgColor:"#F6F5F8",bounces:!1,hScrollBarEnabled:!1,vScrollBarEnabled:!1,delay:0,animation:{type:"movein",duration:300}});else{var i=[];for(var a in n)i.push(a+"="+JSON.stringify(n[a]));c.top.location.href=t+(0<i.length?"?"+encodeURI(escape(i.join("&"))):"")}},closeWindow:function(e){this.isProd()?api.closeWin({name:e}):c.top.history.back()},closeToWindow:function(e,t){this.isProd()?api.closeToWin({name:e,animation:{type:"reveal",subType:"from_left",duration:300}}):c.top.location.href=t},openFrame:function(e,t,n,i){if((i=i||{}).name=e,this.isProd())api.openFrame({name:e,url:t,rect:{x:n.x||0,y:n.y,w:n.w||"auto",h:n.h||"auto"},pageParam:i,bounces:!1,hScrollBarEnabled:!0,vScrollBarEnabled:!1,reload:!0,progress:!0,allowEdit:!0});else{var a=[];for(var r in i)a.push(r+"="+JSON.stringify(i[r]));var o=document.getElementById("app"),s=document.createElement("iframe"),u=n.y||0,p=(n.h||this.winHeight()-u)+"px";s.name=e,s.style.width="100%",s.style.border="none",s.style.height=p,s.src=t+(0<a.length?"?"+encodeURI(escape(a.join("&"))):""),o.append(s),c.top.frame=s,console.info("height:".concat(p))}},closeFrame:function(e){this.isProd()?api.closeFrame({name:e}):c.top.document.getElementById("app").removeChild(c.top.document.getElementsByName(e)[0])},winWidth:function(){return this.isProd()?api.winWidth:$api.offset($api.byId("app")).w},winHeight:function(){return this.isProd()?api.winHeight:$api.offset($api.byId("app")).h},emit:function(n,i){this.isProd()?api.sendEvent({name:n,extra:i}):(function e(t){t.postMessage({"event-name":n,extra:i},"*"),t!==t.top&&e(t.parent)}(c),function e(t){t.frames[0]&&(t.frames[0].postMessage({"event-name":n,extra:i},"*"),e(t.frames[0]))}(c))},listen:function(n,i){this.isProd()?api.addEventListener({name:n},function(e){i&&i.apply(null,[e])}):c.addEventListener("message",function(e){var t=e.data;t["event-name"]===n&&i&&i.apply(null,[{value:t.extra}])})},toast:function(e){this.isProd()?api.toast({msg:e,duration:2e3,location:"middle"}):console.info(e)},alert:function(e,t){this.isProd()&&api.alert({title:e,msg:t})},confirm:function(e,t,n,i){this.isProd()&&api.confirm({title:e,msg:t},function(e){2===e.buttonIndex?n&&n():i&&i()})},openPicker:function(e,t){util.app.isProd()?api.openPicker({type:"date",title:e},function(e){e&&t(new Date(e.year,e.month-1,e.day))}):t()},actionSheet:function(e,n,i){util.app.isProd()?api.actionSheet({title:e,buttons:n},function(e){var t=e.buttonIndex;t<=n.length&&i(t-1)}):i(0)},text2audio:function(e){var t=api.require("bdTTS");t.init(),t.speak({text:e})},getPicture:function(e,n){util.app.isProd()?api.getPicture({sourceType:e,mediaValue:"pic",destinationType:"url",allowEdit:!0,encodingType:"jpg",quality:40,saveToPhotoAlbum:!0},function(e,t){e.data&&!t&&n(e.data)}):n("")},imageClip:function(e,t,n,i){var a;util.app.isProd()?(a=api.require("FNImageClip"),a.reset(),a.open({rect:{x:0,y:t.y,w:api.winWidth,h:t.h},srcPath:e,highDefinition:!0,style:{mask:"rgba(0,0,0,0.8)",clip:{w:n.width,h:n.height,borderWidth:1,appearance:n.shape}},mode:"clip"},function(e,t){e&&!t&&i(e)})):i("")},loading:function(e){this.isProd()&&api.showProgress({style:"default",animationType:"fade",title:"",text:e||"",modal:!0})},hideLoading:function(){this.isProd()&&api.hideProgress()}}}(window),function(e){function r(e){return{"y+":e.getFullYear(),"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours()%12==0?12:e.getHours()%12,"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()}}function m(e,t){t=t||o,"string"==typeof e&&(e=e.replace(/-/g,"/")),e=new Date(e);var n=r(e);for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(1<RegExp.$1.length?2<RegExp.$1.length?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}[e.getDay()+""])),n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t}var o="yyyy-MM-dd HH:mm:ss";e.dateutil={parse:function(e,t){t=t||o;var n=r(new Date);for(var i in n){var a=new RegExp(i);a.test(t)&&(n[i]=(e+"").substr(a.exec(t).index,t.match(a).toString().length))}return new Date(+n["y+"],n["M+"]-1,+n["d+"],+n["H+"],+n["m+"],+n["s+"],+n["S+"])},format:m,addDay:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},calendar:function(e,t){for(var n,i,a=(n=e,new Date(n.getFullYear(),n.getMonth(),1)),r=(i=e,new Date(i.getFullYear(),i.getMonth()+1,0)),o=a.getDay(),s=o+(r.getDate()-a.getDate()+1),u=s%7!=0?s+(7-s%7):s,p=new Array(u),c=0;c<u;c++){var l=null,d=c<o,f=s-1<c,g=a.getFullYear(),h=a.getMonth();d||f?t&&(l=d?new Date(g,h,c-o+1):new Date(g,h+1,c-s+1)):l=new Date(g,h,a.getDate()+c-o),l&&(p[c]={date:l.getDate(),currentMonth:!d&&!f,datestr:m(l,"yyyy-MM-dd")})}return p},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getMaxDates:function(e,t){return 2===t?util.date.isLeapYear(e)?29:28:-1<[1,3,5,7,8,10,12].indexOf(t)?31:30}}}(window),function(t){apputil.isProd()||t.document.addEventListener("keyup",function(e){"Escape"===e.key&&t.top.history.back()}),t.util={app:apputil,date:dateutil,array:arrayutil,string:stringutil}}(window);